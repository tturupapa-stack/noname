# 클로드 코드 MCP 스킬 설정 가이드

## 개요

클로드 코드(Claude Code)에서 "당신이 잠든 사이" 프로젝트의 MCP 스킬을 사용하는 방법입니다.

## MCP 서버 정보

- **서버 이름**: `briefing-generator`
- **실행 파일**: `/Users/larkkim/while-you-were-sleeping-dashboard/mcp-server/server.py`
- **Transport**: stdio
- **언어**: Python 3

## 설정 방법

### 1. 클로드 코드 설정 파일 위치

클로드 코드의 MCP 설정 파일은 일반적으로 다음 위치에 있습니다:

**macOS:**
```
~/Library/Application Support/Claude/claude_desktop_config.json
```

또는

```
~/.config/claude/claude_desktop_config.json
```

### 2. 설정 파일 내용

클로드 코드 설정 파일에 다음을 추가하세요:

```json
{
  "mcpServers": {
    "briefing-generator": {
      "command": "python",
      "args": [
        "/Users/larkkim/while-you-were-sleeping-dashboard/mcp-server/server.py"
      ],
      "env": {
        "ANTHROPIC_API_KEY": "YOUR_ANTHROPIC_API_KEY_HERE",
        "EXA_API_KEY": "YOUR_EXA_API_KEY_HERE"
      }
    }
  }
}
```

### 3. 환경 변수 대신 .env 파일 사용 (권장)

환경 변수를 직접 설정 파일에 넣지 않고, .env 파일을 사용하는 것이 더 안전합니다:

```json
{
  "mcpServers": {
    "briefing-generator": {
      "command": "python",
      "args": [
        "/Users/larkkim/while-you-were-sleeping-dashboard/mcp-server/server.py"
      ]
    }
  }
}
```

이 경우 MCP 서버가 프로젝트 루트의 `.env` 파일을 자동으로 읽습니다.

### 4. 의존성 확인

MCP 서버를 실행하기 전에 필요한 패키지가 설치되어 있는지 확인하세요:

```bash
cd /Users/larkkim/while-you-were-sleeping-dashboard/mcp-server
pip install -r requirements.txt
```

필요한 패키지:
- mcp>=0.9.0
- anthropic>=0.34.0
- yahooquery>=2.3.7
- exa-py>=1.0.0
- python-dotenv>=1.0.0
- pydantic>=2.0.0
- httpx>=0.27.0

### 5. 테스트

클로드 코드를 재시작한 후, 다음과 같이 사용할 수 있습니다:

```
@generate_briefing ticker="TSLA" news_count=3
```

또는 자동으로 화제 종목을 선정하려면:

```
@generate_briefing
```

## 문제 해결

### MCP 서버가 시작되지 않는 경우

1. **Python 경로 확인**:
   ```bash
   which python
   ```
   또는
   ```bash
   which python3
   ```
   설정 파일의 `command`를 `python3`로 변경할 수 있습니다.

2. **의존성 확인**:
   ```bash
   cd /Users/larkkim/while-you-were-sleeping-dashboard/mcp-server
   pip list | grep -E "mcp|anthropic|yahooquery|exa"
   ```

3. **환경 변수 확인**:
   ```bash
   cd /Users/larkkim/while-you-were-sleeping-dashboard
   python -c "from dotenv import load_dotenv; import os; load_dotenv(); print('ANTHROPIC_API_KEY:', 'OK' if os.getenv('ANTHROPIC_API_KEY') else 'NOT SET')"
   ```

### API 키 오류

- `ANTHROPIC_API_KEY`가 올바르게 설정되었는지 확인
- API 키가 유효한지 확인
- Exa API 키도 함께 설정되어 있는지 확인

## 참고

- MCP 서버는 stdio를 통해 통신하므로 별도의 포트 설정이 필요 없습니다.
- 환경 변수는 설정 파일에 직접 넣거나, .env 파일을 통해 전달할 수 있습니다.
- 프로젝트 루트의 `.env` 파일이 있으면 자동으로 로드됩니다.

