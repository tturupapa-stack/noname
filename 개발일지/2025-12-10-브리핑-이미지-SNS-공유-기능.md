# 개발일지 - 브리핑 이미지 SNS 공유 기능

**작성 시각**: 2025-12-10

## 해결하고자 한 문제
- 사용자가 받은 아침 브리핑을 이미지로 변환하여 SNS에 쉽게 공유할 수 있도록 함
- 브리핑 내용을 시각적으로 정리된 카드 형태로 생성하여 공유 효과 극대화
- 서비스 인지도 향상 및 바이럴 마케팅 효과

## 해결된 것
✅ **공유 버튼**
- `ShareButton` 컴포넌트 생성
- `BriefingCard` 우측 상단에 아이콘 버튼 추가
- `BriefingDetailPage`에 "이 브리핑 공유하기" 버튼 추가
- 호버 시 툴팁 표시

✅ **이미지 생성**
- `html-to-image` 라이브러리 사용
- 브리핑 이미지 카드 자동 생성
- 그라데이션 배경, 제목, 요약, 핵심 포인트 포함
- 워터마크: "당신이 잠든 사이 | 오전 7시 브리핑"
- 1080x1080 크기 (인스타그램 최적화)
- 웹폰트 로딩 대기 로직 포함

✅ **공유 채널**
- 카카오톡: 네이티브 공유 또는 링크 복사
- 트위터/X: Web Intent API
- 페이스북: Share Dialog
- 링크 복사: 클립보드 복사 + 토스트 알림
- 텍스트 복사: 브리핑 텍스트 복사
- 이미지 다운로드: PNG 파일 저장
- 네이티브 공유: 모바일 Web Share API 지원

✅ **공유 모달**
- `ShareModal` 컴포넌트 생성
- 이미지 미리보기
- "이미지 다시 생성" 버튼
- 각 SNS별 브랜드 컬러 아이콘
- 로딩 인디케이터
- 에러 처리 및 안내 메시지

✅ **공유 추적**
- 로컬스토리지에 공유 히스토리 저장
- 브리핑별 공유 횟수 추적
- 채널별 공유 통계
- 가장 많이 공유된 브리핑 TOP 5 조회 가능

✅ **에러 처리 및 성능**
- 이미지 생성 실패 시 대체 텍스트 공유
- 브라우저 미지원 기능 안내
- 네트워크 오류 재시도 옵션
- 이미지 생성 로딩 인디케이터
- 웹폰트 로딩 대기

✅ **접근성**
- 키보드 네비게이션 지원
- 스크린 리더 지원 (aria-label)
- 다크 모드/라이트 모드 대응

## 해결되지 않은 것 / 향후 개선 필요
⚠️ **Open Graph 메타 태그**
- 동적으로 브리핑별 OG 태그 생성 미구현
- URL 공유 시 미리보기 최적화 필요

⚠️ **카카오톡 SDK**
- 현재는 네이티브 공유 또는 링크 복사만 지원
- 카카오톡 SDK 연동 시 더 나은 공유 경험 제공 가능

⚠️ **이미지 템플릿 커스터마이징**
- 사용자가 제목/내용 편집 불가
- 다양한 템플릿 선택 옵션 없음

⚠️ **QR 코드**
- 앱/웹 접속용 QR 코드 생성 미구현

## 기술적 세부사항

### 사용한 기술/라이브러리
- **html-to-image**: HTML을 PNG/JPEG로 변환
- **react-share**: SNS 공유 컴포넌트 (설치했지만 직접 구현)
- **Web Share API**: 네이티브 공유

### 주요 파일 구조
```
utils/
  ├── shareUtils.ts        # 이미지 생성 및 공유 유틸리티
  └── shareStorage.ts     # 공유 히스토리 저장소

components/
  ├── ShareButton.tsx     # 공유 버튼
  └── ShareModal.tsx      # 공유 모달
```

### 이미지 생성 프로세스
1. DOM에 임시 컨테이너 생성
2. 브리핑 내용을 HTML로 구성
3. 그라데이션 배경, 제목, 요약, 핵심 포인트 추가
4. 워터마크 및 날짜 정보 추가
5. html-to-image로 PNG 변환
6. DOM에서 임시 컨테이너 제거
7. Data URL 반환

### 공유 전략
- **Android Chrome**: beforeinstallprompt 이벤트 활용
- **iOS Safari**: Web Share API 또는 수동 가이드
- **Desktop**: Web Share API 또는 링크 복사
- **Fallback**: 링크/텍스트 복사

## 향후 개발을 위한 컨텍스트

### 다음 개발자가 알아야 할 정보
1. **이미지 생성**: `generateBriefingImage` 함수는 DOM을 조작하므로 주의 필요
   - 임시 요소는 반드시 제거해야 함
   - 웹폰트 로딩 대기 필요

2. **공유 채널**: 각 플랫폼별로 다른 API 사용
   - 트위터: Web Intent API (새 창 열기)
   - 페이스북: Share Dialog (새 창 열기)
   - 카카오톡: SDK 연동 또는 네이티브 공유

3. **공유 추적**: 로컬스토리지에 저장되므로 실제 분석을 위해서는 서버 연동 필요
   - Google Analytics 이벤트 추가 가능
   - 서버 API로 공유 데이터 전송 가능

4. **이미지 최적화**: 현재는 고품질(quality: 0.9)로 생성
   - 용량이 큰 경우 압축 옵션 추가 고려
   - WebP 형식 지원 고려

### 확장 가능성
- 이미지 템플릿 커스터마이징 (사용자 편집)
- 다양한 템플릿 선택
- QR 코드 생성
- 공유 통계 대시보드
- 공유 링크 추적 (UTM 파라미터)
- Open Graph 메타 태그 동적 생성


